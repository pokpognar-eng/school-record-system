<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>พิมพ์รายงาน</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Sarabun', sans-serif; background: white; padding: 10mm; }
    @page { margin: 0; }
    
    /* Landscape */
    .page-landscape { width: 297mm; height: 210mm; padding: 10mm; }
    /* Portrait */
    .page-portrait { width: 210mm; min-height: 297mm; padding: 10mm; }
    
    h1 { font-size: 18pt; font-weight: bold; text-align: center; margin: 0 0 10px 0; }
    p { font-size: 16pt; text-align: center; margin: 0 0 20px 0; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #000; padding: 4px; text-align: center; }
    th { background: #f0f0f0; font-weight: bold; }
    .signature-section { font-size: 11pt; margin-top: 25pt; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div id="print-content"></div>
  <script>
    // รับข้อมูลจาก parent
    window.addEventListener('message', function(e) {
      if (e.data.type === 'print') {
        document.getElementById('print-content').innerHTML = e.data.html;
        
        // ซ่อนหน้าที่ไม่ใช่
        const toHide = e.data.orientation === 'landscape' ? 'portrait' : 'landscape';
        document.querySelectorAll(`.page-${toHide}`).forEach(el => el.classList.add('hidden'));
        
        // พิมพ์ทันที
        setTimeout(() => {
          window.print();
        }, 100);
      }
    });
  </script>
</body>
</html>